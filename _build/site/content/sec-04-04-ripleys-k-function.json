{"version":2,"kind":"Article","sha256":"b00931e6adf3285bbf87299e2ebadcb17e18f3d5de90ea004c3e2757fa9f345e","slug":"sec-04-04-ripleys-k-function","location":"/src/content/chapter_4/sec_04-04-Ripleys-K-Function.md","dependencies":[],"frontmatter":{"title":"Ripley’s K-function","content_includes_title":false,"authors":[{"nameParsed":{"literal":"Benny Chin","given":"Benny","family":"Chin"},"name":"Benny Chin","affiliations":["GIS Unit, Geography, National University of Singapore"],"id":"contributors-myst-generated-uid-0"}],"license":{"content":{"id":"CC-BY-NC-ND-4.0","url":"https://creativecommons.org/licenses/by-nc-nd/4.0/","name":"Creative Commons Attribution Non Commercial No Derivatives 4.0 International","CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"github":"https://github.com/wcchin/geo-stat-vis","keywords":["GIS","GIScience","Cartography","Spatial Analysis"],"copyright":"2025 National University of Singapore","affiliations":[{"id":"GIS Unit, Geography, National University of Singapore","name":"GIS Unit, Geography, National University of Singapore"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/wcchin/geo-stat-vis/blob/main/src/content/chapter_4/sec_04-04-Ripleys-K-Function.md","edit_url":"https://github.com/wcchin/geo-stat-vis/edit/main/src/content/chapter_4/sec_04-04-Ripleys-K-Function.md","thumbnail":"/three_strategies_for-d3ce33966d3690ab0e67edb7bd52d68e.png","exports":[{"format":"md","filename":"sec_04-04-Ripleys-K-Function.md","url":"/sec_04-04-Ripleys-K--4bce51c630734ecd9d76a11ad6b25913.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The 2 Distance-based Approaches","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wFLJUf9qtE"}],"identifier":"the-2-distance-based-approaches","label":"The 2 Distance-based Approaches","html_id":"the-2-distance-based-approaches","implicit":true,"key":"XlwNQkFYSc"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/three_strategies_for-d3ce33966d3690ab0e67edb7bd52d68e.png","alt":"Everyone look for the nearest neighbor vs. everyone draw a series of search buffer (radius).","align":"center","data":{"altTextIsAutoGenerated":true},"key":"NmdU8wdvr8","urlSource":"../resources/w05-img/three_strategies_for_point_pattern_2b.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Everyone look for the nearest neighbor vs. everyone draw a series of search buffer (radius).","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"uuOi3vjcfg"}],"key":"PSfP9nk3z3"}],"key":"MEDBtAeG5W"}],"enumerator":"1","key":"ibRINm4DkV"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"In this section, we focus on the second approach.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"G8I0sYqOhQ"}],"key":"LyZgmRYstA"},{"type":"heading","depth":2,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Bus Stops Distribution","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"CA329WDk6L"}],"identifier":"bus-stops-distribution","label":"Bus Stops Distribution","html_id":"bus-stops-distribution","implicit":true,"key":"a9ikBN49tD"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Take bus stops distribution for example:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"u0ukj5H0oG"}],"key":"UnXMUx9dXc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Bus stops usually constructed in pairs, at both sides of a street.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"dUq8qBsv7T"}],"key":"Im6S5xl1GA"}],"key":"jv8Ugp661U"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The nearest neighbor is at a short distance (opposite of street), but the second nearest may not.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"e5dvEy0Soz"}],"key":"NpihJeZrST"}],"key":"CaCjJfqMlG"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Is it a “real” clustered pattern?","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"LKofmhnW6V"}],"key":"fBYjPcNyiy"}],"key":"ZThrfDiWsa"}],"key":"mBF4VkqmBH"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/Bus_Stop_nearest_nei-7331f7782e22aab59d2d35b7b61e9cfa.png","alt":"Bus Stops distribution. Is the nearest neighbor distance ‘meaningful’?","align":"center","data":{"altTextIsAutoGenerated":true},"key":"wLkwwwTzEd","urlSource":"../resources/w05-img/Bus_Stop_nearest_neighbor.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Bus Stops distribution. Is the nearest neighbor distance ‘meaningful’?","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"TkthQM7BZ4"}],"key":"ipcHjiXrHx"}],"key":"Bn9VUQ2moJ"}],"enumerator":"2","key":"TKMFOtNruU"},{"type":"heading","depth":2,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"The Search Radius Approach","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"momBSqwizL"}],"identifier":"the-search-radius-approach","label":"The Search Radius Approach","html_id":"the-search-radius-approach","implicit":true,"key":"qKDdlnc1Yb"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"The Ripley’s K-function:","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"pNr5GzVO8P"}],"key":"BhnknFe24j"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":34,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Generate a series of search radius (SR), from low to high","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"BVjhfGPHML"}],"key":"cqR4lOOczN"}],"key":"NIKWaf1ahC"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Search for pairs of points fall within every SR","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"PCGidP3mF6"}],"key":"KhBDSekMQh"}],"key":"XA8Qdd9XNN"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The implication:","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"zjP2M72cIK"}],"key":"u9n4jTiL8A"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"if a lot of pairs are found within a short SR: the points are clustered at this distance.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"aioIFV7cPb"}],"key":"a1sM7M1C5s"}],"key":"i7dxpnLUg0"}],"key":"xfg5VMAKFd"}],"key":"LEJfNzXrT4"}],"key":"pGR2Np4A9N"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/simulate_kfunc-112ab4eb81d1b84323d7fef3bc24e7fd.gif","alt":"Simulation of the buffer area and counting.","align":"center","data":{"altTextIsAutoGenerated":true},"key":"kpXjoHrM75","urlSource":"../resources/w05-img/simulate_kfunc.gif"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Simulation of the buffer area and counting.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"avSqYTMVRR"}],"key":"JLFv00hU1W"}],"key":"lWmLsw9Csz"}],"enumerator":"3","key":"z0mHDQdrjw"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"A common transformation of the K-function:","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"jDKwYlWX8x"}],"key":"LuFTAGAFq0"},{"type":"math","value":"L(d) = \\sqrt{\\frac{A \\times \\text{pairs}_d }{\\pi n(n-1)}}","position":{"start":{"line":49,"column":1},"end":{"line":51,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msqrt><mfrac><mrow><mi>A</mi><mo>×</mo><msub><mtext>pairs</mtext><mi>d</mi></msub></mrow><mrow><mi>π</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mfrac></msqrt></mrow><annotation encoding=\"application/x-tex\">L(d) = \\sqrt{\\frac{A \\times \\text{pairs}_d }{\\pi n(n-1)}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.04em;vertical-align:-1.194em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.846em;\"><span class=\"svg-align\" style=\"top:-5em;\"><span class=\"pstrut\" style=\"height:5em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">πn</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">pairs</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.242em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.806em;\"><span class=\"pstrut\" style=\"height:5em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:3.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='3.08em' viewBox='0 0 400000 3240' preserveAspectRatio='xMinYMin slice'><path d='M473,2793\nc339.3,-1799.3,509.3,-2700,510,-2702 l0 -0\nc3.3,-7.3,9.3,-11,18,-11 H400000v40H1017.7\ns-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200\nc0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26\ns76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,\n606zM1001 80h400000v40H1017.7z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.194em;\"><span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"OqFmfYhRNq"},{"type":"math","value":"\\text{pairs}\\_d = \\sum\\_{i=1}^n \\sum\\_{j=1, j\\neq i}^n w\\_{ij}","position":{"start":{"line":53,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>pairs</mtext><mi mathvariant=\"normal\">_</mi><mi>d</mi><mo>=</mo><mo>∑</mo><mi mathvariant=\"normal\">_</mi><msup><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msup><mo>∑</mo><mi mathvariant=\"normal\">_</mi><msup><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi><mo mathvariant=\"normal\">≠</mo><mi>i</mi></mrow><mi>n</mi></msup><mi>w</mi><mi mathvariant=\"normal\">_</mi><mrow><mi>i</mi><mi>j</mi></mrow></mrow><annotation encoding=\"application/x-tex\">\\text{pairs}\\_d = \\sum\\_{i=1}^n \\sum\\_{j=1, j\\neq i}^n w\\_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0044em;vertical-align:-0.31em;\"></span><span class=\"mord text\"><span class=\"mord\">pairs</span></span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.6em;vertical-align:-0.55em;\"></span><span class=\"mop op-symbol large-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-symbol large-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">i</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7487em;\"><span style=\"top:-3.1473em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span></span>","enumerator":"2","key":"AeVonP8dQZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":57,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"L(d)","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(d)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span></span>","key":"vpVCc7fbzc"},{"type":"text","value":": the k-function value at search radius ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"qkPbDLFmDI"},{"type":"inlineMath","value":"d","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"e3HT0J5isS"}],"key":"tYbiBvuHNq"}],"key":"S1Kq2Mzn6Z"},{"type":"listItem","spread":true,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\text{pairs}_d","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mtext>pairs</mtext><mi>d</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\text{pairs}_d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.912em;vertical-align:-0.2441em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">pairs</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.242em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Uj01Gm6cIi"},{"type":"text","value":": the number of pairs of points with distance less than ","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"miUfG08cxP"},{"type":"inlineMath","value":"d","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"CGj4uSD8XE"}],"key":"J64B4dPwMa"}],"key":"gQv6tDulFN"},{"type":"listItem","spread":true,"position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"w_{ij}","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">w_{ij}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PnyVQeV2CD"},{"type":"text","value":": equal to 1 if non-weighted; weighting for edge-correction","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"ATKbKmXYkI"}],"key":"hrGvca2OJ6"}],"key":"Xqy0sFEmyG"},{"type":"listItem","spread":true,"position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"A","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"hVq2FmDPY0"},{"type":"text","value":": Area of study","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"pFmfvkepbe"}],"key":"df3gCDKlYe"}],"key":"wsWRDXrtgY"},{"type":"listItem","spread":true,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"n","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"DBZ0A7Mba5"},{"type":"text","value":": total number of points","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"AMVcrMCIc4"}],"key":"NV0tvfQcgG"}],"key":"W8rjzNByxv"},{"type":"listItem","spread":true,"position":{"start":{"line":62,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"n(n-1)","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">n(n-1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"dXSXLNUg6D"},{"type":"text","value":": total number of all pairs","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"tpVkTAL78L"}],"key":"nu71PGNvzC"}],"key":"U7stBTzGGu"}],"key":"DUpBXD12yE"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"More info: ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"ICAUsmvtiy"},{"type":"link","url":"https://pro.arcgis.com/en/pro-app/3.1/tool-reference/spatial-statistics/h-how-multi-distance-spatial-cluster-analysis-ripl.htm","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"ESRI ArcGIS: How multi-distance spatial cluster analysis works.","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"XUMs549PHY"}],"urlSource":"https://pro.arcgis.com/en/pro-app/3.1/tool-reference/spatial-statistics/h-how-multi-distance-spatial-cluster-analysis-ripl.htm","key":"wQUiTB3QbL"}],"key":"FW85e1ttBX"},{"type":"heading","depth":2,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Testing for K-functions","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"JdBb37zVX9"}],"identifier":"testing-for-k-functions","label":"Testing for K-functions","html_id":"testing-for-k-functions","implicit":true,"key":"gtJJhohngP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":69,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"How high is high enough","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"i6vfycAIQz"}],"key":"IrTyoywVTl"},{"type":"text","value":" to be considered as clustered?","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"oma5erAnSv"}],"key":"zz9iTBkvfe"}],"key":"b2g95OmZRG"},{"type":"listItem","spread":true,"position":{"start":{"line":70,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"To compare them with CSR, ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"NZRb6sc0K2"},{"type":"emphasis","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"Monte Carlo Simulation","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"il6pCEAglP"}],"key":"n5VdhsKmDd"},{"type":"text","value":" can be used (again)","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"nlww5AwFsV"}],"key":"Vmt3aRdhHl"}],"key":"yu8DxoLBdX"}],"key":"DurzZ4b5mD"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/kfunc_arcGIS_redraw-dd4ee3a9e519c1802a4aba65b5131ba2.png","alt":"The clustered and dispersed range of K-function curve.","align":"center","data":{"altTextIsAutoGenerated":true},"key":"JiWkFIiXCI","urlSource":"../resources/w05-img/kfunc_arcGIS_redraw.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"The clustered and dispersed range of K-function curve.","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"lc9yh5dVcK"}],"key":"zKzWTOgGWk"}],"key":"uTSOjGEYeA"}],"enumerator":"4","key":"zsY2jmRohz"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"For demonstration: 10 random patterns are generated","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"M1bWxsa5JT"}],"key":"j1MPqnOTu2"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/k_function_4cases_ra-2994dc776b889273ff269abe9f63934b.png","alt":"K-function curve of the four examples and the k-function curves of the corresponding 10 random distributions.","align":"center","data":{"altTextIsAutoGenerated":true},"key":"IIlgcysisk","urlSource":"../resources/w05-img/k_function_4cases_rand.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"K-function curve of the four examples and the k-function curves of the corresponding 10 random distributions.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"j7xK1t7aCF"}],"key":"grmKXkZL6H"}],"key":"SBHPCIyDhH"}],"enumerator":"5","key":"Tlh5UhaHyS"},{"type":"paragraph","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"Calculate 95% Confidence envelop. See ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"hcXTQiNIQH"},{"type":"link","url":"https://pro.arcgis.com/en/pro-app/3.1/tool-reference/spatial-statistics/h-how-multi-distance-spatial-cluster-analysis-ripl.htm","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"ESRI","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"xvtAvovg9j"}],"urlSource":"https://pro.arcgis.com/en/pro-app/3.1/tool-reference/spatial-statistics/h-how-multi-distance-spatial-cluster-analysis-ripl.htm","key":"bY0nlQgIrU"},{"type":"text","value":" for more details.","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"qP2gaTzjIx"}],"key":"r5cPLkWVVU"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/k_function_4cases_ra-2994dc776b889273ff269abe9f63934b.png","alt":"The k-function curves and the confidence interval (Monte Carlo Simulation) for the 4 examples.","align":"center","data":{"altTextIsAutoGenerated":true},"key":"Y7UdLLyE0B","urlSource":"../resources/w05-img/k_function_4cases_rand.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"text","value":"The k-function curves and the confidence interval (Monte Carlo Simulation) for the 4 examples.","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"oECSd8QgIV"}],"key":"rPNUKHiXPP"}],"key":"ppQB5SfwwB"}],"enumerator":"6","key":"X2LVETUYYO"},{"type":"heading","depth":2,"position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"Comparison between NNA and K-function results","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"pTm39MX3X6"}],"identifier":"comparison-between-nna-and-k-function-results","label":"Comparison between NNA and K-function results","html_id":"comparison-between-nna-and-k-function-results","implicit":true,"key":"XpuAhQ7WCK"},{"type":"container","kind":"figure","children":[{"type":"container","kind":"figure","subcontainer":true,"children":[{"type":"image","url":"/drawing_nna_res_2-27f71032b5a7cabf567b5ecc8cee4779.png","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"alt":"Nearest Neighbor Analysis","data":{"altTextIsAutoGenerated":true},"key":"jvgna1WVLR","urlSource":"../resources/w05-img/drawing_nna_res_2.png"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"captionNumber","kind":"figure","label":"NNA","identifier":"nna","html_id":"nna","enumerator":"7a","children":[{"type":"text","value":"(","key":"IW2YirUTdP"},{"type":"text","value":"a","key":"TY1dHpjOeg"},{"type":"text","value":")","key":"qhaFKiGRCo"}],"template":"({subEnumerator})","key":"OfkqSJN7RB"},{"type":"text","value":"Nearest Neighbor Analysis","key":"PZpgby8L3I"}],"key":"Dt9xiFLMcY"}],"key":"CSrVnx6pSW"}],"label":"NNA","identifier":"nna","html_id":"nna","parentEnumerator":"7","enumerator":"a","key":"dmqaOXE2yj"},{"type":"container","kind":"figure","subcontainer":true,"children":[{"type":"image","url":"/k_function_4cases_ci-7a17e8dc9b30c67d4453a7260f48fd4b.png","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"alt":"Ripley's K-function","data":{"altTextIsAutoGenerated":true},"key":"X3bHEMSELo","urlSource":"../resources/w05-img/k_function_4cases_ci.png"},{"type":"caption","children":[{"type":"paragraph","children":[{"type":"captionNumber","kind":"figure","label":"kfunc","identifier":"kfunc","html_id":"kfunc","enumerator":"7b","children":[{"type":"text","value":"(","key":"EyrGL8tfA4"},{"type":"text","value":"b","key":"VC12Q2P5AN"},{"type":"text","value":")","key":"wmUix91Fu6"}],"template":"({subEnumerator})","key":"Vpt8GLAo16"},{"type":"text","value":"Ripley's K-function","key":"SZKOiOAeNz"}],"key":"o2M3inO9cw"}],"key":"uMz9eV24zJ"}],"label":"kfunc","identifier":"kfunc","html_id":"kfunc","parentEnumerator":"7","enumerator":"b","key":"lI48ENYN4l"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"comparison-nna-kfunc","identifier":"comparison-nna-kfunc","html_id":"comparison-nna-kfunc","enumerator":"7","children":[{"type":"text","value":"Figure ","key":"VtNDRsIZ9O"},{"type":"text","value":"7","key":"tIZ2FuHGf9"},{"type":"text","value":":","key":"cQpd7o0HCH"}],"template":"Figure %s:","key":"kLPHg8Egzh"},{"type":"text","value":"The results for the 4 examples using two methods.","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"bm0fbciWJI"}],"key":"uiMB9QvsnY"}],"key":"YeHmUCqmTJ"}],"label":"comparison-nna-kfunc","identifier":"comparison-nna-kfunc","enumerator":"7","html_id":"comparison-nna-kfunc","key":"VgCR4TxKIv"},{"type":"heading","depth":2,"position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"Summary: Repley’s K-function","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"FdLHrcVzSj"}],"identifier":"summary-repleys-k-function","label":"Summary: Repley’s K-function","html_id":"summary-repleys-k-function","implicit":true,"key":"pDfBMhPWze"},{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"strong","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"Purpose","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"BRh8VkRaO6"}],"key":"C0tyGpiWCr"}],"key":"zB97w0ZWXX"},{"type":"paragraph","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"Ripley’s K function is a tool used to analyze spatial point patterns, helping researchers understand the spatial relationships among events or objects in a given study area.","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"uQxndTMs9e"}],"key":"cYfPaU0Aig"},{"type":"paragraph","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"strong","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"Functionality","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"MWHvJam6uN"}],"key":"lUCXHd6lpG"}],"key":"gF3fOhWRy6"},{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"The K function estimates the expected number of points within a given distance from a randomly chosen point, providing insights into clustering, dispersion, or randomness in the spatial pattern.","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"fEbq2eGVLO"}],"key":"RMjIyqcjTP"},{"type":"paragraph","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"strong","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Key features","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"jSjuuDC1hv"}],"key":"PhmwqfaCUM"}],"key":"L8dXkjrIp8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":132,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The K function can be plotted as a function of distance to visualize changes in spatial interactions at different scales.","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"id6xBLWgsb"}],"key":"sqW9qOisuw"}],"key":"fLwc9glkSC"},{"type":"listItem","spread":true,"position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It can be compared with theoretical models, such as complete spatial randomness (CSR), to assess deviations from expected patterns.","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"ngQwC47gdy"}],"key":"T1Rtx26RO9"}],"key":"n2rW759oY4"}],"key":"RlywXae6D7"}],"key":"LWAT5HxMrd"}],"key":"v6JXkTZmgw"},"references":{"cite":{"order":[],"data":{}}}}